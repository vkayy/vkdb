\chapter{Usage}
\hypertarget{md_usage}{}\label{md_usage}\index{Usage@{Usage}}
\label{md_usage_autotoc_md9}%
\Hypertarget{md_usage_autotoc_md9}%
\hypertarget{md_usage_autotoc_md10}{}\doxysection{\texorpdfstring{Running locally (not needed)}{Running locally (not needed)}}\label{md_usage_autotoc_md10}
\hypertarget{md_usage_autotoc_md11}{}\doxysubsection{\texorpdfstring{Installation}{Installation}}\label{md_usage_autotoc_md11}
First, clone the project and {\ttfamily cd} into the directory. 
\begin{DoxyCode}{0}
\DoxyCodeLine{git\ clone\ https://github.com/vkayy/vkdb.git\ \&\&\ cd\ vkdb}

\end{DoxyCode}
 Then, make the build directory and build the project with CMake. 
\begin{DoxyCode}{0}
\DoxyCodeLine{mkdir\ build\ \&\&\ cd\ build\ \&\&\ cmake\ ..\ \&\&\ make}

\end{DoxyCode}
\hypertarget{md_usage_autotoc_md12}{}\doxysubsection{\texorpdfstring{Tests}{Tests}}\label{md_usage_autotoc_md12}
From the build folder, you can run the tests. 
\begin{DoxyCode}{0}
\DoxyCodeLine{./tests/vkdb\_tests}

\end{DoxyCode}
\hypertarget{md_usage_autotoc_md13}{}\doxysubsection{\texorpdfstring{Examples}{Examples}}\label{md_usage_autotoc_md13}
From the build folder, you can also run any of the examples. 
\begin{DoxyCode}{0}
\DoxyCodeLine{./examples/<filename>}

\end{DoxyCode}
\hypertarget{md_usage_autotoc_md14}{}\doxysection{\texorpdfstring{Using the library}{Using the library}}\label{md_usage_autotoc_md14}
\hypertarget{md_usage_autotoc_md15}{}\doxysubsection{\texorpdfstring{Setup}{Setup}}\label{md_usage_autotoc_md15}
Add this to your {\ttfamily CMake\+Lists.\+txt} file—it lets you use vkdb by fetching the most recent version into your project\textquotesingle{}s build.


\begin{DoxyCode}{0}
\DoxyCodeLine{include(FetchContent)}
\DoxyCodeLine{FetchContent\_Declare(}
\DoxyCodeLine{\ \ \ \ vkdb}
\DoxyCodeLine{\ \ \ \ GIT\_REPOSITORY\ https://github.com/vkayy/vkdb.git}
\DoxyCodeLine{\ \ \ \ GIT\_TAG\ \ \ \ \ \ \ \ main}
\DoxyCodeLine{)}
\DoxyCodeLine{FetchContent\_MakeAvailable(vkdb)}
\DoxyCodeLine{target\_link\_libraries(\$\{PROJECT\_NAME\}\ vkdb)}

\end{DoxyCode}
\hypertarget{md_usage_autotoc_md16}{}\doxysubsection{\texorpdfstring{Interface}{Interface}}\label{md_usage_autotoc_md16}
Simply include the database header, and you\textquotesingle{}ll have access to the database API.


\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{preprocessor}{\#include\ <vkdb/database.h>}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keywordtype}{int}\ main()\ \ \{}
\DoxyCodeLine{\ \ \mbox{\hyperlink{classvkdb_1_1_database}{vkdb::Database}}\ db\{\textcolor{stringliteral}{"{}example-\/db"{}}\};}
\DoxyCodeLine{\ \ db.createTable(\textcolor{stringliteral}{"{}example-\/table"{}});}
\DoxyCodeLine{\ \ \textcolor{comment}{//\ ...}}
\DoxyCodeLine{\}}

\end{DoxyCode}
\hypertarget{md_usage_autotoc_md17}{}\doxysubsection{\texorpdfstring{Table management}{Table management}}\label{md_usage_autotoc_md17}
You can manipulate tables with the database API, both with methods or queries.


\begin{DoxyCode}{0}
\DoxyCodeLine{db.createTable(\textcolor{stringliteral}{"{}sensor\_data"{}})}
\DoxyCodeLine{\ \ .addTagColumn(\textcolor{stringliteral}{"{}location"{}})}
\DoxyCodeLine{\ \ .addTagColumn(\textcolor{stringliteral}{"{}type"{}});}
\DoxyCodeLine{}
\DoxyCodeLine{db.run(\textcolor{stringliteral}{"{}REMOVE\ TAGS\ type\ FROM\ sensor\_data;"{}})}

\end{DoxyCode}
\hypertarget{md_usage_autotoc_md18}{}\doxysubsection{\texorpdfstring{General queries}{General queries}}\label{md_usage_autotoc_md18}
With the database API, you can run queries via strings, files, and the REPL.


\begin{DoxyCode}{0}
\DoxyCodeLine{test\_db}
\DoxyCodeLine{\ \ .run(\textcolor{stringliteral}{"{}CREATE\ TABLE\ temp\ TAGS\ tag1,\ tag2;"{}})}
\DoxyCodeLine{\ \ .runFile(std::filesystem::current\_path()\ /\ \textcolor{stringliteral}{"{}../examples/vq\_setup.vq"{}})}
\DoxyCodeLine{\ \ .runPrompt()}
\DoxyCodeLine{\ \ .clear();}

\end{DoxyCode}


With the table API, you can run queries via the query builder.


\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{keyword}{auto}\ sum\{table\_replay.query()}
\DoxyCodeLine{\ \ .whereTimestampBetween(0,\ 999)}
\DoxyCodeLine{\ \ .whereMetricIs(\textcolor{stringliteral}{"{}metric"{}})}
\DoxyCodeLine{\ \ .whereTagsContain(\{\textcolor{stringliteral}{"{}tag1"{}},\ \textcolor{stringliteral}{"{}value1"{}}\})}
\DoxyCodeLine{\ \ .sum()}
\DoxyCodeLine{\};}

\end{DoxyCode}
\hypertarget{md_usage_autotoc_md19}{}\doxysubsection{\texorpdfstring{Playground}{Playground}}\label{md_usage_autotoc_md19}
You can also play around with vq by running {\ttfamily vkdb\+::\+VQ\+::run...()}. This operates on a reserved database called {\ttfamily interpreter\+\_\+default} (which, consequently, you should not use as a database name).


\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{preprocessor}{\#include\ <vkdb/vq.h>}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keywordtype}{int}\ main()\ \{}
\DoxyCodeLine{\ \ vkdb::VQ::runPrompt();}
\DoxyCodeLine{\}}

\end{DoxyCode}


\tabulinesep=1mm
\begin{longtabu}spread 0pt [c]{*{1}{|X[-1]}|}
\hline
\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{  
\begin{DoxyInlineImage}
\includegraphics[height=\baselineskip,keepaspectratio=true]{vq-playground.png}%vq-\/playground.png
\end{DoxyInlineImage}
   

}\\\cline{1-1}
\endfirsthead
\hline
\endfoot
\hline
\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{  
\begin{DoxyInlineImage}
\includegraphics[height=\baselineskip,keepaspectratio=true]{vq-playground.png}%vq-\/playground.png
\end{DoxyInlineImage}
   

}\\\cline{1-1}
\endhead
\PBS\centering {\itshape The vq playground REPL.}   \\\cline{1-1}
\end{longtabu}


This is generally for experimental purposes—there\textquotesingle{}s not much to gain from it in practice besides having a playground.\hypertarget{md_usage_autotoc_md20}{}\doxysubsection{\texorpdfstring{Mock data}{Mock data}}\label{md_usage_autotoc_md20}
Feel free to use {\ttfamily vkdb\+::random\texorpdfstring{$<$}{<}\texorpdfstring{$>$}{>}}. Any arithmetic type (with no cv-\/ or ref-\/qualifiers) can be passed in as a template argument, and you can optionally pass in a lower and upper bound (inclusive).


\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{keyword}{auto}\ random\_int\{vkdb::random<int>(-\/100'000,\ 100'000)\};}
\DoxyCodeLine{\textcolor{keyword}{auto}\ random\_double\{vkdb::random<double>(-\/10.0,\ 10.0)\};}

\end{DoxyCode}
 